<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>미술치료 아바타 퀴즈</title>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 40px auto; line-height: 1.6; }
    h1 { margin-bottom: 8px; }
    .question { margin: 24px 0; padding: 16px; border: 1px solid #ddd; border-radius: 8px; }
    button { padding: 8px 16px; font-size: 16px; cursor: pointer; }
    #log, #feedback { white-space: pre-line; margin-top: 16px; padding: 12px; border-radius: 8px; }
    #log { background: #f7f7f7; }
    #feedback { background: #eef9ff; }
  </style>
</head>
<body>
  <h1>미술치료 아바타 퀴즈 (데모)</h1>
  <p>미술치료 아바타가 알고 있는 내용을 점검하기 위한 객관식 / 주관식 문제입니다.</p>

  <!-- 1번: 객관식 문제 (미술치료 종류 + 시간) -->
  <div class="question">
    <p><strong>1번 문제.</strong> 다음 중 <strong>개별 미술치료 한 회기</strong>의 일반적인 소요 시간으로 가장 알맞은 것은 무엇일까요?</p>
    <label><input type="radio" name="q1" value="1"> 1. 10~15분</label><br>
    <label><input type="radio" name="q1" value="2"> 2. 20~30분</label><br>
    <label><input type="radio" name="q1" value="3"> 3. 40~50분</label><br>
    <label><input type="radio" name="q1" value="4"> 4. 2시간 이상</label><br>
  </div>

  <!-- 2번: 주관식 문제 (필요 도구) -->
  <div class="question">
    <p><strong>2번 문제.</strong> 본인이 알고 있는 <strong>그림검사(예: HTP, KFD, BDT 등)</strong> 중 하나를 골라서, 실시할 때 필요한 기본 미술 도구를 3가지 이상 적어 보세요.</p>
    <textarea id="q2" rows="4" style="width:100%;" placeholder="예: 연필, 지우개, A4용지, 색연필 등"></textarea>
  </div>

  <button id="submitBtn">제출하기</button>

  <h2>① 응답 요약 (지식 업데이트)</h2>
  <div id="log"></div>

  <h2>② 아바타가 줄 피드백(지금은 텍스트로만 예시)</h2>
  <div id="feedback"></div>

  <script>
    // 0. 아바타가 기본적으로 알고 있어야 하는 '미술치료 지식' 요약 (네가 학습시킨 내용 요약해서 넣으면 됨)
    const baseKnowledge = `
    - 미술치료는 개별 미술치료, 집단 미술치료, 가족 미술치료 등으로 나뉜다.
    - 개별 미술치료 한 회기는 보통 약 40~50분 정도 소요되는 경우가 많다.
    - 대표적인 그림검사로는 HTP, KFD, BDT, DDS 등이 있으며, 기본 도구로는 연필, 지우개, 종이, 색연필/크레파스 등이 사용된다.
    `;

    // 1. 사용자별로 쌓이는 지식(응답 로그)을 담아둘 배열
    const userKnowledge = [];

    document.getElementById("submitBtn").onclick = function () {
      // (1) 1번 객관식 답
      const q1Choice = document.querySelector('input[name="q1"]:checked');
      if (!q1Choice) {
        alert("1번 객관식 답을 선택해 주세요.");
        return;
      }
      const q1Value = q1Choice.value;

      // (2) 2번 주관식 답
      const q2Value = document.getElementById("q2").value.trim();
      if (!q2Value) {
        alert("2번 주관식 답을 적어 주세요.");
        return;
      }

      // (3) 교수님이 말한 형식대로 요약 문장 만들기
      const summary1 = `1번 응답자는 1번 질문(개별 미술치료 회기 시간)에 ${q1Value}번을 선택하였다.`;
      const summary2 = `1번 응답자는 2번 질문(그림검사 도구)에 "${q2Value}" 라고 적었다.`;

      // (4) 배열에 '지식'으로 저장
      userKnowledge.push(summary1);
      userKnowledge.push(summary2);

      // (5) 화면에 현재까지의 지식 로그 보여주기
      document.getElementById("log").innerText = userKnowledge.join("\n");

      // (6) 간단한 정답 체크 + 피드백 (지금은 JS 버전, 나중에 OpenAI로 교체 가능)
      let feedbackText = "";

      // 정답: 3번(40~50분)이라고 가정 (네가 배운 시간에 맞게 수정해도 됨)
      if (q1Value === "3") {
        feedbackText += "✅ 1번 문제: 정답입니다!\n";
        feedbackText += "개별 미술치료 한 회기는 보통 약 40~50분 정도를 기준으로 진행하는 경우가 많습니다.\n\n";
      } else {
        feedbackText += "❌ 1번 문제: 아쉽지만 정답은 3번(40~50분)입니다.\n";
        feedbackText += "미술치료는 라포 형성, 작업, 정리·마무리까지 시간이 필요하기 때문에 너무 짧지도, 너무 길지도 않은 40~50분 정도를 많이 사용합니다.\n\n";
      }

      feedbackText += `2번에서 적어주신 도구("${q2Value}")는 선택한 그림검사를 진행할 때 활용할 수 있는 자료입니다.\n`;
      feedbackText += "도구를 잘 준비하는 것은 내담자가 안전하게 표현할 수 있는 환경을 만드는 데 중요해요 🙂";

      document.getElementById("feedback").innerText = feedbackText;

      // (7) ★ 여기 부분을 나중에 OpenAI + D-ID로 바꾸면 된다
      //  - baseKnowledge + userKnowledge 내용을 합쳐서
      //  - 백엔드(스트림릿)로 보내고
      //  - 스트림릿에서 OpenAI에 프롬프트로 전달한 뒤,
      //  - 그 응답을 D-ID 아바타가 말하게 하면 됨.
    };
  </script>
</body>
</html>
